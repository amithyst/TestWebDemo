{# templates/MC_command/formsets/_firework_explosion_row.html #}
<div class="firework-form-row dynamic-form" id="{{ form.prefix }}-row">
    {# 隐藏字段，如 id 和 DELETE #}
    {% for hidden_field in form.hidden_fields %}{{ hidden_field }}{% endfor %}

    <div class="fw-fields-grid">
        <div class="form-field">
            {{ form.shape.label_tag }}
            {{ form.shape }}
            <div class="errorlist">{{ form.shape.errors }}</div>
        </div>
        <div class="form-field">
            {{ form.repeat_count.label_tag }}
            {{ form.repeat_count }}
            <div class="errorlist">{{ form.repeat_count.errors }}</div>
        </div>
        <div class="form-field-checkbox">
            {{ form.has_trail }}
            <label for="{{ form.has_trail.id_for_label }}">拖尾</label>
        </div>
        <div class="form-field-checkbox">
            {{ form.has_twinkle }}
            <label for="{{ form.has_twinkle.id_for_label }}">闪烁</label>
        </div>
    </div>

    <div class="fw-color-section">
        <div class="fw-color-group">
            <label>主颜色</label>
            <div class="color-controls">
                <input type="color" class="color-picker" data-type="colors" value="#ff0000">
                <button type="button" class="btn btn-sm add-color-btn" data-type="colors">添加颜色</button>
                <div class="random-toggle">
                    <input type="checkbox" id="{{ form.prefix }}-colors-random" class="random-color-cb" data-type="colors">
                    <label for="{{ form.prefix }}-colors-random">随机</label>
                </div>
            </div>
            <div class="color-palette" data-type="colors"></div>
            {{ form.colors }} {# 隐藏的 input #}
            <div class="errorlist">{{ form.colors.errors }}</div>
        </div>
        <div class="fw-color-group">
            <label>淡出颜色</label>
            <div class="color-controls">
                <input type="color" class="color-picker" data-type="fade_colors" value="#ff0000">
                <button type="button" class="btn btn-sm add-color-btn" data-type="fade_colors">添加颜色</button>
                 <div class="random-toggle">
                    <input type="checkbox" id="{{ form.prefix }}-fade_colors-random" class="random-color-cb" data-type="fade_colors">
                    <label for="{{ form.prefix }}-fade_colors-random">随机</label>
                </div>
            </div>
            <div class="color-palette" data-type="fade_colors"></div>
            {{ form.fade_colors }} {# 隐藏的 input #}
            <div class="errorlist">{{ form.fade_colors.errors }}</div>
        </div>
    </div>
    
    {% if form.instance.pk or form.DELETE.value %}
        <div class="delete-checkbox-container">
            {{ form.DELETE.label_tag }} {{ form.DELETE }}
        </div>
    {% endif %}
    <button type="button" class="action-btn btn-delete delete-row-btn">删除此效果</button>
</div>